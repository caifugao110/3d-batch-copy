# 3D 文件批量复制工具（3D Batch Copy Tool）

## 📦 项目简介

**3D 文件批量复制工具** 是一个高效、智能的自动化脚本与 GUI 程序，专为公司内部批量调3D图开发，用于从多个网络驱动器目录中，根据提供的文件清单（CSV），快速批量查找并复制 `.step` 文件到本地目录。

> ✅ 支持模糊匹配  
> ✅ 支持多线程高速复制  
> ✅ 支持重试机制  
> ✅ 支持日志记录与统计报告  
> ✅ 支持图形界面（GUI）与命令行双模式  
> ✅ 已打包为独立 EXE，无需安装 Python 环境

---

## 🧰 主要功能

| 功能 | 描述 |
|------|------|
| 📂 批量复制 | 根据 CSV 清单，自动从多个源目录复制 .step 文件 |
| 🔍 智能匹配 | 模糊匹配文件名，忽略大小写、L 后缀、括号内容 |
| 🧵 多线程 | 支持最多 12 线程并行复制，极大提升效率 |
| 🔄 重试机制 | 复制失败自动重试 3 次，避免网络抖动影响 |
| 🧹 自动清理 | 每次运行前自动清空目标目录旧文件 |
| 📝 日志记录 | 生成 CSV 日志，记录复制结果与来源路径 |
| 📊 统计报告 | 显示总文件数、成功/失败/未找到数量及耗时 |
| 🖥️ 图形界面 | 支持可视化操作，适合非技术用户 |
| 📁 独立运行 | 已打包为 EXE，双击即可运行，无需安装依赖 |

---

## 📁 项目结构

```
3D-Batch-Copy/
├── 3d-batch-copy.exe          # 主程序（GUI 模式）
├── config.ini                 # 配置文件（路径+线程设置）
├── Original file list.csv     # 原始文件清单（输入）
├── Copy step list.csv         # 复制结果日志（输出）
├── copystep/                  # 复制目标文件夹（自动创建）
└── README.md                  # 本文件
```

---

## 🚀 EXE 使用说明（图形界面）

> 适用于已通过 PyInstaller 打包的 `3D文件批量复制工具.exe`

### ✅ 步骤一：准备文件

1. 将所有文件放在同一个文件夹下：
   - `3D文件批量复制工具.exe`
   - `config.ini`
   - `Original file list.csv`

2. 确保你有权限访问配置文件中指定的网络驱动器（如 `Y:\`）

---

### ✅ 步骤二：配置清单文件

- 打开 `Original file list.csv`
- 每行填写一个文件名（不含扩展名），例如：

```
SDEX-C0681
SDEX-C1036
SDZX-C1195
```

> ⚠️ 不需要写 `.step`，程序会自动匹配并复制

---

### ✅ 步骤三：双击运行 EXE

- 启动后会自动加载：
  - `config.ini`
  - `Original file list.csv`

- 界面预览：

![image-20251028093223691](C:\Users\gaoj\AppData\Roaming\Typora\typora-user-images\image-20251028093223691.png)

---

### ✅ 步骤四：开始复制

1. 点击 **【开始批量复制】**
2. 程序将：
   - 自动清理 `copystep/` 目录
   - 扫描所有源目录
   - 构建索引
   - 多线程复制文件
   - 实时显示进度与日志
3. 完成后弹出提示框

---

### ✅ 步骤五：查看结果

- 复制成功的文件保存在：`copystep/`
- 日志文件：`Copy step list.csv`
- 可点击 **【查看日志文件】** 打开 CSV 日志

---

## ⚙️ 配置文件说明（config.ini）

```ini
[Paths]
drive_letter = Y                          # 网络驱动器盘符
target_dir_name = copystep                # 本地目标文件夹
original_list_file = Original file list.csv
log_file = Copy step list.csv

[SourceDirectories]
dir1 = 设计一课3D资料\03-SV GUN STEP
dir2 = 吉利标准化\07吉利库STEP
...

[Settings]
max_workers = 12                          # 最大线程数
retry_attempts = 3                        # 失败重试次数
```

---

## 🧪 示例：CSV 清单与匹配规则

| 原始清单名 | 实际匹配文件名 | 说明 |
|-------------|------------------|------|
| SDEX-C0681 | SDEX-C0681L.step | 自动忽略末尾 L |
| SDEX-C1036 | SDEX-C1036L(500-340).step | 忽略括号内容 |
| SDZX-C1195 | sdzx-c1195.step | 不区分大小写 |

---

## 📊 统计报告示例

```
============================================================
📊 处理统计报告
============================================================
  总文件数: 11
  ✅ 成功复制: 9 (81.8%)
  ❌ 未找到: 2 (18.2%)
  ⚠️ 复制错误: 0
⏱️ 总耗时: 5.2秒 | 平均速度: 2.1 文件/秒
============================================================
```

---

## ⚠️ 常见问题

| 问题 | 解决方法 |
|------|----------|
| ❌ 未找到文件 | 检查文件名是否匹配、源目录是否正确 |
| 🚫 无法访问 Y:\ | 确保网络驱动器已映射并登录 |
| 🧵 复制速度慢 | 增加 `max_workers`（建议不超过 16） |
| 🧹 旧文件未清理 | 程序会自动清理，无需手动删除 |
| 🪟 杀毒软件拦截 | 添加信任，防止误报 |

---

## 🧪 高级用法（命令行模式）

> 如果你使用的是源码版本（非exe），可通过命令行运行：

```bash
python 3d-batch-copy.py
```

> 如果你想要将源码打包为exe文件，可通过命令行运行：

```bash
# 用绝对路径的PyInstaller手动打包
C:\Users\gaoj\AppData\Local\Programs\Python\Python313\Scripts\pyinstaller -F -w main_gui.py
```

---

## 📌 注意事项

- 仅支持 `.step` 文件（不区分大小写）
- 文件名匹配为“前缀模糊匹配”，非完全精确
- 日志文件会覆盖上次结果，如需保留请手动备份
- 请勿在复制过程中关闭程序，否则可能导致文件不完整

---

## 📬 联系与支持

📧 技术支持：gaoj@obara.com.cn  
📅 更新日期：2025-10-28  
🔗 项目地址：https://github.com/caifugao110/3d-batch-copy

---

## 📄 授权说明

© 2025 Tobin | 版权所有  
仅限内部使用，禁止外传或商业用途

---

🎉 **祝你使用愉快！如有问题，请联系 IT 支持或开发团队。**